#!/bin/bash

echo "moving dotfiles for chezmoi..."

# relocate this checkout for chezmoi
[[ -d ~/.local/share ]] || mkdir -p ~/.local/share
[[ -e ~/.local/share/chezmoi ]] && rm -rf ~/.local/share/chezmoi
[[ -d ~/.local/share/chezmoi ]] || mv ~/.dotfiles ~/.local/share/chezmoi

# link the usual ~/src/indirect/dotfiles location
[[ -d ~/src/indirect ]] || mkdir -p ~/src/indirect
[[ -L ~/src/indirect/dotfiles ]] || ln -s ~/.local/share/chezmoi ~/src/indirect/dotfiles

# link the conventional .dotfiles location
[[ -L ~/.dotfiles ]] || ln -s ~/.local/share/chezmoi ~/.dotfiles

echo "applying dotfiles"
set +v
chezmoi apply
